<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="jakarta.faces.facelets"
                xmlns:h="jakarta.faces.html"
                xmlns:f="jakarta.faces.core"
                template="/template/main.xhtml">

    <ui:define name="head">
        <h:outputStylesheet library="css" name="form.css"/>
    </ui:define>

    <!-- Load director using f:viewParam and f:viewAction -->
    <f:metadata>
        <f:viewParam name="directorId" value="#{movieCreateView.directorId}" required="true"/>
        <f:viewAction action="#{movieCreateView.loadDirector}" />
        <f:event type="preRenderView" listener="#{movieCreateView.redirectIfDirectorIsNull}" />
    </f:metadata>

    <ui:define name="content">
        <article class="container mt-4">
            <header>
                <h2>Add a New Movie for <h:outputText value="#{movieCreateView.director.name}"/></h2>
            </header>

            <h:form styleClass="mt-3">
                <h:panelGrid columns="2" columnClasses="col-3,col-9" styleClass="mb-3">

                    <h:outputLabel for="title" value="Title:"/>
                    <h:inputText id="title" value="#{movieCreateView.movie.title}" required="true"/>

                    <h:outputLabel for="releaseDate" value="Release Date:"/>
                    <h:inputText id="releaseDate" value="#{movieCreateView.movie.releaseDate}" required="true"/>

                    <h:outputLabel for="genres" value="Genres:"/>
                    <h:selectManyCheckbox id="genres" value="#{movieCreateView.movie.genres}" layout="pageDirection">
                        <f:selectItems value="#{movieCreateView.availableGenres}" var="g"
                                       itemValue="#{g}" itemLabel="#{g}"/>
                    </h:selectManyCheckbox>
                </h:panelGrid>

                <div class="mt-3">
                    <h:commandButton value="Add Movie"
                                     action="#{movieCreateView.createMovie}"
                                     styleClass="btn btn-success me-2"/>
                    <h:link outcome="/view/director/director_details"
                            value="Cancel"
                            styleClass="btn btn-secondary">
                        <f:param name="id" value="#{movieCreateView.director.id}"/>
                    </h:link>
                </div>
            </h:form>
        </article>
    </ui:define>
</ui:composition>
